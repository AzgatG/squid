module.exports = class init1656833326752 {
  name = 'init1656833326752'

  async up(db) {
    await db.query(`CREATE TABLE "registration_event" ("id" character varying NOT NULL, "block_number" integer NOT NULL, "transaction_id" bytea NOT NULL, "kind" jsonb NOT NULL, "registration_id" character varying NOT NULL, CONSTRAINT "PK_e273290b4292fe15ea3b0d03511" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_bf80863f4fbd3dd947b91256b6" ON "registration_event" ("registration_id") `)
    await db.query(`CREATE TABLE "registration" ("id" character varying NOT NULL, "registration_date" numeric NOT NULL, "expiry_date" numeric NOT NULL, "cost" numeric, "label_name" text, "domain_id" character varying, "registrant_id" character varying NOT NULL, CONSTRAINT "PK_cb23dc9d28df8801b15e9e2b8d6" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_a2348ea430f304b2835a86361b" ON "registration" ("domain_id") `)
    await db.query(`CREATE INDEX "IDX_71c21cfbf21b51f211313e11d8" ON "registration" ("registrant_id") `)
    await db.query(`CREATE TABLE "account" ("id" character varying NOT NULL, CONSTRAINT "PK_54115ee388cdb6d86bb4bf5b2ea" PRIMARY KEY ("id"))`)
    await db.query(`CREATE TABLE "resolver_event" ("id" character varying NOT NULL, "block_number" integer NOT NULL, "transaction_id" bytea NOT NULL, "kind" jsonb NOT NULL, "resolver_id" character varying NOT NULL, CONSTRAINT "PK_ce6e9100b433fbaa1bdc7f897a6" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_30ace15cb41d832c08eae27c84" ON "resolver_event" ("resolver_id") `)
    await db.query(`CREATE TABLE "resolver" ("id" character varying NOT NULL, "address" bytea NOT NULL, "content_hash" bytea, "texts" text array, "coin_types" numeric array, "domain_id" character varying, "addr_id" character varying, CONSTRAINT "PK_b6dce266610be08e8e81cd4d897" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_2b8d86cb40182edda882e901f2" ON "resolver" ("domain_id") `)
    await db.query(`CREATE INDEX "IDX_0d373b33adb77b2f6f3c24ea77" ON "resolver" ("addr_id") `)
    await db.query(`CREATE TABLE "domain_event" ("id" character varying NOT NULL, "block_number" integer NOT NULL, "transaction_id" bytea NOT NULL, "kind" jsonb NOT NULL, "domain_id" character varying NOT NULL, CONSTRAINT "PK_f901502d0301da69fb8cebbb8f2" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_261d0375325374d5a347936b10" ON "domain_event" ("domain_id") `)
    await db.query(`CREATE TABLE "domain" ("id" character varying NOT NULL, "name" text, "label_name" text, "labelhash" bytea, "ttl" numeric, "is_migrated" boolean NOT NULL, "created_at" numeric NOT NULL, "parent_id" character varying, "resolved_address_id" character varying, "owner_id" character varying NOT NULL, "resolver_id" character varying, CONSTRAINT "PK_27e3ec3ea0ae02c8c5bceab3ba9" PRIMARY KEY ("id"))`)
    await db.query(`CREATE INDEX "IDX_7d85eb18ed8935de858c8a3f22" ON "domain" ("parent_id") `)
    await db.query(`CREATE INDEX "IDX_b597038b01d0ab26ce426aa3ea" ON "domain" ("resolved_address_id") `)
    await db.query(`CREATE INDEX "IDX_4e21006496ef49995f4cf5ff8c" ON "domain" ("owner_id") `)
    await db.query(`CREATE INDEX "IDX_739629023aaf16951a6b481d59" ON "domain" ("resolver_id") `)
    await db.query(`ALTER TABLE "registration_event" ADD CONSTRAINT "FK_bf80863f4fbd3dd947b91256b63" FOREIGN KEY ("registration_id") REFERENCES "registration"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "registration" ADD CONSTRAINT "FK_a2348ea430f304b2835a86361b8" FOREIGN KEY ("domain_id") REFERENCES "domain"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "registration" ADD CONSTRAINT "FK_71c21cfbf21b51f211313e11d80" FOREIGN KEY ("registrant_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "resolver_event" ADD CONSTRAINT "FK_30ace15cb41d832c08eae27c84f" FOREIGN KEY ("resolver_id") REFERENCES "resolver"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "resolver" ADD CONSTRAINT "FK_2b8d86cb40182edda882e901f24" FOREIGN KEY ("domain_id") REFERENCES "domain"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "resolver" ADD CONSTRAINT "FK_0d373b33adb77b2f6f3c24ea770" FOREIGN KEY ("addr_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "domain_event" ADD CONSTRAINT "FK_261d0375325374d5a347936b105" FOREIGN KEY ("domain_id") REFERENCES "domain"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "domain" ADD CONSTRAINT "FK_7d85eb18ed8935de858c8a3f222" FOREIGN KEY ("parent_id") REFERENCES "domain"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "domain" ADD CONSTRAINT "FK_b597038b01d0ab26ce426aa3eaa" FOREIGN KEY ("resolved_address_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "domain" ADD CONSTRAINT "FK_4e21006496ef49995f4cf5ff8c4" FOREIGN KEY ("owner_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    await db.query(`ALTER TABLE "domain" ADD CONSTRAINT "FK_739629023aaf16951a6b481d599" FOREIGN KEY ("resolver_id") REFERENCES "resolver"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
  }

  async down(db) {
    await db.query(`DROP TABLE "registration_event"`)
    await db.query(`DROP INDEX "public"."IDX_bf80863f4fbd3dd947b91256b6"`)
    await db.query(`DROP TABLE "registration"`)
    await db.query(`DROP INDEX "public"."IDX_a2348ea430f304b2835a86361b"`)
    await db.query(`DROP INDEX "public"."IDX_71c21cfbf21b51f211313e11d8"`)
    await db.query(`DROP TABLE "account"`)
    await db.query(`DROP TABLE "resolver_event"`)
    await db.query(`DROP INDEX "public"."IDX_30ace15cb41d832c08eae27c84"`)
    await db.query(`DROP TABLE "resolver"`)
    await db.query(`DROP INDEX "public"."IDX_2b8d86cb40182edda882e901f2"`)
    await db.query(`DROP INDEX "public"."IDX_0d373b33adb77b2f6f3c24ea77"`)
    await db.query(`DROP TABLE "domain_event"`)
    await db.query(`DROP INDEX "public"."IDX_261d0375325374d5a347936b10"`)
    await db.query(`DROP TABLE "domain"`)
    await db.query(`DROP INDEX "public"."IDX_7d85eb18ed8935de858c8a3f22"`)
    await db.query(`DROP INDEX "public"."IDX_b597038b01d0ab26ce426aa3ea"`)
    await db.query(`DROP INDEX "public"."IDX_4e21006496ef49995f4cf5ff8c"`)
    await db.query(`DROP INDEX "public"."IDX_739629023aaf16951a6b481d59"`)
    await db.query(`ALTER TABLE "registration_event" DROP CONSTRAINT "FK_bf80863f4fbd3dd947b91256b63"`)
    await db.query(`ALTER TABLE "registration" DROP CONSTRAINT "FK_a2348ea430f304b2835a86361b8"`)
    await db.query(`ALTER TABLE "registration" DROP CONSTRAINT "FK_71c21cfbf21b51f211313e11d80"`)
    await db.query(`ALTER TABLE "resolver_event" DROP CONSTRAINT "FK_30ace15cb41d832c08eae27c84f"`)
    await db.query(`ALTER TABLE "resolver" DROP CONSTRAINT "FK_2b8d86cb40182edda882e901f24"`)
    await db.query(`ALTER TABLE "resolver" DROP CONSTRAINT "FK_0d373b33adb77b2f6f3c24ea770"`)
    await db.query(`ALTER TABLE "domain_event" DROP CONSTRAINT "FK_261d0375325374d5a347936b105"`)
    await db.query(`ALTER TABLE "domain" DROP CONSTRAINT "FK_7d85eb18ed8935de858c8a3f222"`)
    await db.query(`ALTER TABLE "domain" DROP CONSTRAINT "FK_b597038b01d0ab26ce426aa3eaa"`)
    await db.query(`ALTER TABLE "domain" DROP CONSTRAINT "FK_4e21006496ef49995f4cf5ff8c4"`)
    await db.query(`ALTER TABLE "domain" DROP CONSTRAINT "FK_739629023aaf16951a6b481d599"`)
  }
}
